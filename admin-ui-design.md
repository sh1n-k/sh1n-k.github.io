---
layout: default
title: 관리자 화면 설계
nav_order: 6
---

# 관리자 화면 설계

목표는 “운영자가 조직의 메시지 업체를 바꿀 수 있다”를 넘어서, **실수 가능성을 전제로 안전장치를 내장**하는 것이다. 설계 포인트는 (1) 입력 오류를 사전에 줄이고, (2) 변경 영향도를 명확히 보여주며, (3) 문제가 생겼을 때 추적/복구가 가능하도록 하는 것이다.

<a href="sample-ui.html" target="_blank" rel="noopener noreferrer">
  샘플 UI 보기 (HTML)
</a>

## **화면 흐름**

1. 조직 목록(검색/필터)
- 검색: 조직명, 조직 ID
- 목록 컬럼(예시): 조직명, 조직 ID, 현재 업체, 설정 상태(기본값/설정됨), 최종 수정자, 최종 수정일
- 액션: “설정 보기/변경” 버튼 → 조직 상세 설정 화면

2. 조직 상세 설정(현재 상태 확인)
- 현재 업체 표시(예: CloudMsg / SendTalk / 기본값 CloudMsg)
- 현재 설정 요약: “설정됨”이면 인증정보는 **마스킹된 형태**로만 표시
- 변경 이력(Audit Log) 탭/영역(권장): 최근 변경 5~10건

3. 업체 선택 + 인증정보 입력
- 업체 선택: 라디오(CloudMsg / SendTalk) + “기본값 사용(CloudMsg)” 옵션(선택)
- 업체 선택에 따라 **동적 폼** 렌더링(필요 필드만 노출)
- 입력 UX:
  - 필수/선택 필드 구분
  - 형식 안내(placeholder + helper text)
  - 유효성 검증 실패는 필드 하단에 인라인 에러

4. 연결 테스트 → 저장
- “연결 테스트” 버튼: 필수 필드가 모두 유효할 때만 활성화
- 테스트 중 로딩 표시, 성공/실패 결과 메시지
- 기본 정책: **연결 테스트 성공 후에만 저장 버튼 활성화**
- 저장 시 확인 모달:
  - “이전 업체 → 신규 업체”
  - 영향 안내: “변경 즉시 해당 조직의 모든 메시지 발송에 적용”
- 저장 성공 후 토스트 + 목록으로 복귀

5. 삭제(기본값으로 복귀)
- “설정 삭제(기본값으로 복귀)” 제공(권장: 위험도 높으므로 보호)
- 삭제 확인 모달에서 **조직명 재입력** 같은 하드 가드
- 삭제 후 “기본값 CloudMsg 적용”을 명확히 표시

## **UI 결정 사항(고민 포인트와 선택)**

1. 동적 폼 vs 고정 폼
- 선택: **동적 폼**
- 근거: 불필요한 필드를 숨겨 **오입력 가능성을 낮춤**. 운영 화면은 “깔끔함”보다 “실수 방지”가 우선.

2. 연결 테스트 필수화
- 선택: **기본 필수화**
- 근거: 잘못된 키 저장은 즉시 장애로 이어질 수 있음.
- 예외(선택): 슈퍼어드민만 “강제 저장” 허용 가능. 단, Audit Log에 강제 저장 사실을 남겨야 함.

3. 인증정보 마스킹 정책
- 선택: **부분 마스킹**
- 근거: 운영자가 “어떤 키가 설정되어 있는지” 정도는 식별해야 혼선을 줄일 수 있음.
- 주의: 원문 조회/복호화 표시 기능은 제공하지 않는 것을 권장.

4. 변경 확인 절차 강도
- 선택: **항상 확인 모달**
- 근거: 조직 단위 설정은 영향 범위가 크다. 실수 방지를 위해 2단계 확인이 필요.

5. 동시 수정 충돌 처리
- 선택: **낙관적 락(버전) + 저장 시 충돌 메시지**
- 근거: 운영자는 실시간 협업 가능성이 있고, “마지막 저장이 덮어쓰기”는 사고로 이어진다.

## **예외/엣지 케이스와 대응**

1. 입력값 형식 오류/누락
- 대응: 필드별 인라인 에러 + 연결 테스트 버튼 비활성화
- 예: 전화번호/키 형식, 필수 값 누락

2. 연결 테스트 실패
- 원인 유형별 메시지:
  - 인증 실패(401/403): “인증정보가 유효하지 않습니다.”
  - 타임아웃/네트워크: “업체 서버에 연결할 수 없습니다. 잠시 후 재시도”
  - 기타: “오류 코드/요청 ID” 노출(운영 추적용)
- 저장 버튼은 비활성 유지

3. 업체 장애(테스트가 계속 실패)
- 대응(정책 선택 필요):
  - 원칙: 저장 불가(안전 우선)
  - 예외: 슈퍼어드민 강제 저장(운영 필요 시) + 이력 기록 + 경고 배너

4. 설정 변경 시점에 발송이 진행 중
- 설명: “변경 시점 이후 요청부터 신규 업체 적용”
- 발송 이력에 “사용 업체”를 기록하므로 추적 가능
- 운영 안내: 트래픽이 낮은 시간대 변경 권장(선택)

5. 설정 삭제 후 문제(원래 SendTalk 계약 조직이 CloudMsg로 발송)
- 대응: 삭제는 “복귀”지만 계약 상 이슈가 될 수 있음 → 삭제 모달에서 영향 경고
- Audit Log에서 이전 설정을 확인해 복구할 수 있게 함(복구 버튼 제공은 선택)

6. 지원하지 않는 업체 코드(서버/클라이언트 불일치)
- 대응: 업체 목록은 서버 API에서 내려주고, UI는 그 목록으로만 렌더링
- 서버는 유효하지 않은 code 요청 시 명확한 4xx 에러

---
