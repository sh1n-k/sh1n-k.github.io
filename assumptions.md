---
layout: default
title: 가정 세트
nav_order: 4
---

# 가정 세트

이 과제는 정보가 완전하지 않은 상황을 전제로 하므로, “사실”과 “가정”을 분리해야 한다. 아래는 설계를 진행하기 위해 필요한 **최종 가정(전제) 세트**이며, 이후 서버 설계/관리자 화면 설계는 이 전제를 기준으로 작성한다.

## **1) 작업 범위**

- 범위: **SMS, MMS/LMS, 알림톡**
- 제외: **앱 푸시**(이번 요구 범위 밖)

## **2) 업체 선택 정책**

- 업체 선택 단위는 **조직(Organization) 단위로 1개 업체**
- 메시지 타입별(SMS/알림톡별)로 업체를 달리 선택하는 복잡 케이스는 **범위에서 제외**
- 조직-업체 매핑이 없으면 **기본값은 CloudMsg**로 동작(하위 호환)

## **3) 인증 정보(Secrets) 관리**

- 인증 정보는 **조직 단위로 저장**(조직마다 업체 계약/계정이 다를 수 있음)
- DB에 **암호화 저장**하고, 애플리케이션에서 복호화해 사용
- 조회 시에는 **부분 마스킹**만 허용(원문 노출 금지)

## **4) 조직-업체 매핑 관리 주체와 UI**

- 매핑 변경 주체는 **서비스 운용자(내부 관리자) 및 조직 관리자**  
- 운용자는 **관리자 화면**에서 조직별 업체/인증정보를 입력·변경할 수 있다.
- 고객사(조직 사용자)가 직접 바꾸는 기능은 **제공하지 않는다**(운영 모델 단순화)

## **5) 기존 시스템 호환성**

- 발송 요청을 보내는 기존 클라이언트 API는 **변경하지 않는다**  
- “어느 업체로 발송되는지”는 클라이언트가 알 필요가 없고, 서버 내부에서 결정한다.

## **6) 발송 결과 처리**

- 발송은 **비동기 결과(Webhook)**를 전제로 한다.  
- 발송 이력은 “접수”와 “결과 수신”을 분리해 상태로 관리한다.
- Webhook 엔드포인트는 **업체별 분리**한다.

## **7) 데이터 모델 확장 허용**

- 조직-업체 매핑 테이블을 신규로 추가할 수 있다(업체 코드, 인증정보, 활성화 여부, 생성/수정 일시 등)
- 발송 이력 테이블은 확장 가능하다(예: **업체 코드, 업체 메시지 ID, Webhook 수신 시각**)

## **8) 에러 처리 및 Fallback**

- 업체 API 호출 실패 시 **자동 타 업체 전환(Fallback)**은 구현하지 않는다.
- 재시도 정책은 기존 시스템 정책을 따른다.
- (알림톡 실패 시 SMS/LMS 대체 발송 같은 기능은) 업체 기능/정책에 따라 활용하되, 이번 과제에선 “핵심 목표”가 아니므로 설계에서 우선순위를 낮춘다.

## **운영 관점 추가 가정(실수 방지용)**

- 설정 저장 전 **연결 테스트(credential validation)**를 제공한다. (기본: 성공 후 저장)
- 변경/삭제는 즉시 영향을 줄 수 있으므로 **확인 모달 + 변경 이력 저장**을 포함한다.
- 동일 조직을 여러 운영자가 동시에 수정할 수 있으므로 **낙관적 락(Optimistic Locking)**으로 충돌을 감지한다.

---
